<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Single Card View</title>
    <link rel="stylesheet" href="./style.css">
  </head>
  <body>
    <div class="card-container">
      <div class="header">
        <button class="back-button" onclick="goBack()" title="Go back">
          ←
        </button>
        <h2 class="deck-name" id="deckName">Deck: Pikachu's Team</h2>
      </div>

      <h3 class="main-card-name" id="mainCardName"></h3>

      <div class="carousel-wrapper">
        <button
          class="navigation prev-button"
          onclick="prevCard()"
          title="Previous card"
        >
          ‹
        </button>
        <button
          class="navigation next-button"
          onclick="nextCard()"
          title="Next card"
        >
          ›
        </button>

        <div class="carousel" id="carousel"></div>
      </div>

      <div class="card-indicator" id="cardIndicator"></div>

      <button class="manage-button" onclick="manageCard()">Manage Card</button>
    </div>

    <script>
      const cards = [
        {
          name: 'Pikachu',
          type: 'Electric',
          rarity: 'Rare',
          generation: 'Gen 1',
        },
        {
          name: 'Eevee',
          type: 'Normal',
          rarity: 'Common',
          generation: 'Gen 1',
        },
        {
          name: 'Charmander',
          type: 'Fire',
          rarity: 'Rare',
          generation: 'Gen 1',
        },
        {
          name: 'Bulbasaur',
          type: 'Grass',
          rarity: 'Uncommon',
          generation: 'Gen 1',
        },
        {
          name: 'Squirtle',
          type: 'Water',
          rarity: 'Rare',
          generation: 'Gen 1',
        },
      ];

      let currentIndex = 0;
      let isAnimating = false;
      const carousel = document.getElementById('carousel');
      const mainCardName = document.getElementById('mainCardName');
      const cardIndicator = document.getElementById('cardIndicator');

      function renderCards() {
        carousel.innerHTML = '';
        cardIndicator.innerHTML = '';

        // Create all cards
        cards.forEach((card, index) => {
          const cardDiv = document.createElement('div');
          cardDiv.className = 'card';

          cardDiv.innerHTML = `
          <div class="card-image"></div>
          <div class="card-info">
            <div>${card.type}</div>
            <div>${card.rarity}</div>
            <div>${card.generation}</div>
          </div>
        `;

          carousel.appendChild(cardDiv);

          // Create indicator dots
          const dot = document.createElement('div');
          dot.className = `indicator-dot ${index === currentIndex ? 'active' : ''}`;
          dot.onclick = () => goToCard(index);
          cardIndicator.appendChild(dot);
        });

        // Update main card name
        mainCardName.textContent = cards[currentIndex].name;

        // Position carousel
        carousel.style.transform = `translateX(-${currentIndex * 100}%)`;

        // Update indicators
        updateIndicators();
      }

      function updateIndicators() {
        const dots = cardIndicator.querySelectorAll('.indicator-dot');
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === currentIndex);
        });
      }

      function prevCard() {
        if (isAnimating) return;
        isAnimating = true;

        currentIndex = (currentIndex - 1 + cards.length) % cards.length;
        animateToCard();
      }

      function nextCard() {
        if (isAnimating) return;
        isAnimating = true;

        currentIndex = (currentIndex + 1) % cards.length;
        animateToCard();
      }

      function goToCard(index) {
        if (isAnimating || index === currentIndex) return;
        isAnimating = true;

        currentIndex = index;
        animateToCard();
      }

      function animateToCard() {
        // Update main card name immediately for responsiveness
        mainCardName.textContent = cards[currentIndex].name;

        // Animate carousel
        carousel.style.transform = `translateX(-${currentIndex * 100}%)`;

        // Update indicators
        updateIndicators();

        // Reset animation flag
        setTimeout(() => {
          isAnimating = false;
        }, 400);
      }

      function goBack() {
        // Add a subtle animation before the alert
        const container = document.querySelector('.card-container');
        container.style.transform = 'scale(0.98)';
        container.style.opacity = '0.8';

        setTimeout(() => {
          container.style.transform = 'scale(1)';
          container.style.opacity = '1';
          alert('Going back to Card View...');
        }, 150);
      }

      function manageCard() {
        const currentCard = cards[currentIndex];
        alert(
          `Managing ${currentCard.name}...\n\nCard Details:\n• Type: ${currentCard.type}\n• Rarity: ${currentCard.rarity}\n• Generation: ${currentCard.generation}`,
        );
      }

      // Keyboard navigation
      document.addEventListener('keydown', function (event) {
        switch (event.key) {
          case 'ArrowLeft':
            prevCard();
            break;
          case 'ArrowRight':
            nextCard();
            break;
          case 'Escape':
            goBack();
            break;
        }
      });

      // Touch/swipe support
      let startX = 0;
      let startY = 0;
      let distX = 0;
      let distY = 0;

      carousel.addEventListener('touchstart', function (e) {
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
      });

      carousel.addEventListener('touchmove', function (e) {
        e.preventDefault();
      });

      carousel.addEventListener('touchend', function (e) {
        distX = e.changedTouches[0].clientX - startX;
        distY = e.changedTouches[0].clientY - startY;

        // Check if horizontal swipe is dominant
        if (Math.abs(distX) > Math.abs(distY) && Math.abs(distX) > 50) {
          if (distX > 0) {
            prevCard();
          } else {
            nextCard();
          }
        }
      });

      // Initialize
      renderCards();
    </script>
  </body>
</html>
